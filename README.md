# Coworking Management System

Комплексная система управления коворкинг-пространством с Telegram-ботом для пользователей и веб-админкой для администраторов.

## Описание

Система автоматизирует процессы бронирования рабочих мест в коворкинге, управления клиентами, обработки платежей и техподдержки. Состоит из трех основных компонентов:

- **Telegram-бот** - интерфейс для клиентов (регистрация, бронирование, оплата)
- **Веб-админпанель** - интерфейс для администраторов (управление бронями, пользователями, аналитика)
- **REST API** - связующее звено между компонентами

## Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Telegram Bot  │    │   Web Frontend  │    │   External APIs │
│                 │    │   (React SPA)   │    │  (Rubitime,     │
│                 │    │                 │    │   YooKassa)     │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │
          └──────────────────────┼──────────────────────┘
                                 │
                    ┌─────────────┴──────────────┐
                    │      FastAPI Backend       │
                    │                            │
                    │  ┌──────────────────────┐  │
                    │  │     SQLite DB        │  │
                    │  │   (Thread-safe       │  │
                    │  │    with connection   │  │
                    │  │      pooling)        │  │
                    │  └──────────────────────┘  │
                    └────────────────────────────┘
```

## Основной функционал

### Для клиентов (Telegram-бот):
- Регистрация с реферальной системой
- Просмотр доступных тарифов
- Бронирование рабочих мест
- Интеграция с платежной системой YooKassa
- Система промокодов и скидок
- Техподдержка через тикеты
- Автоматические уведомления

### Для администраторов (Веб-панель):
- Управление пользователями и их данными
- Управление бронированиями (подтверждение, отмена)
- Финансовая аналитика и отчеты
- Система тарифов и промокодов
- Обработка тикетов техподдержки
- Массовые рассылки с медиа
- Гибкая система ролей и разрешений
- Real-time уведомления
- Экспорт данных

## Технический стек

### Backend:
- **FastAPI** - веб-фреймворк
- **SQLAlchemy** - ORM для работы с БД
- **SQLite** - база данных с оптимизацией для многопоточности
- **Aiogram 3** - фреймворк для Telegram-бота
- **PyJWT** - аутентификация через JWT токены
- **Pydantic** - валидация данных

### Frontend:
- **React 18** - пользовательский интерфейс
- **Chakra UI** - UI-библиотека
- **Chart.js** - графики и аналитика
- **Axios** - HTTP-клиент

### Инфраструктура:
- **Docker Compose** - контейнеризация
- **Nginx** - прокси-сервер и раздача статики
- **Python-multipart** - загрузка файлов

### Внешние интеграции:
- **YooKassa** - платежная система
- **Rubitime API** - CRM для салонов красоты
- **Telegram Bot API** - мессенджер

## Особенности реализации

### Безопасность:
- JWT-аутентификация с проверкой разрешений
- Валидация всех входящих данных
- Thread-safe операции с БД
- Кэширование пользователей для оптимизации

### Производительность:
- Асинхронная архитектура
- Connection pooling для БД
- Оптимизированные SQL-запросы
- Кэширование статических ресурсов

### Надежность:
- Автоматические резервные копии БД
- Graceful handling ошибок БД
- Retry механизмы для внешних API
- Health checks для всех сервисов

### UX/UI:
- Responsive дизайн админпанели
- Real-time обновления через polling
- Browser notifications
- Прогрессивное веб-приложение (PWA)

## Установка и запуск

### Предварительные требования:
- Docker и Docker Compose
- Telegram Bot Token
- YooKassa аккаунт (опционально)

### Запуск:

```bash
# Клонировать репозиторий
git clone <repository-url>
cd coworking-system

# Создать файл окружения
cp .env.example .env
# Заполнить необходимые переменные в .env

# Запустить систему
docker-compose up -d

# Проверить статус
docker-compose ps
```

### Переменные окружения:

```env
# Обязательные
BOT_TOKEN=your_telegram_bot_token
ADMIN_TELEGRAM_ID=your_admin_telegram_id
SECRET_KEY=your_secret_key
SECRET_KEY_JWT=your_jwt_secret

# Опциональные
YOKASSA_ACCOUNT_ID=your_yookassa_id
YOKASSA_SECRET_KEY=your_yookassa_secret
RUBITIME_API_KEY=your_rubitime_key
```

Система будет доступна по адресу `http://localhost` (фронтенд) и `http://localhost:8000` (API).

## API Documentation

После запуска системы документация API доступна по адресу:
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

## Структура проекта

```
├── bot/                    # Telegram бот
│   ├── handlers/          # Обработчики команд
│   └── bot.py            # Основной файл бота
├── frontend/              # React приложение
│   ├── src/
│   │   ├── components/   # React компоненты
│   │   ├── sections/     # Страницы админки
│   │   └── utils/        # Утилиты и API клиент
├── routes/               # API маршруты
├── models/               # Модели базы данных
├── schemas/              # Pydantic схемы
├── utils/                # Утилиты и хелперы
├── docker-compose.yml    # Конфигурация Docker
└── requirements.txt      # Python зависимости
```

## Мониторинг и логирование

- Централизованное логирование с ротацией файлов
- Health checks для всех сервисов
- Метрики производительности БД
- Уведомления об ошибках в Telegram

## Лицензия

Проприетарное программное обеспечение. Все права защищены.